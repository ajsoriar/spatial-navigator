/**
 * spatial-navigator
 * JS spatial navigation library.
 * @version 1.1.2 - 2021-06-18
 * @link https://github.com/ajsoriar/spatial-navigator
 * @author Andres J. Soria R. <ajsoriar@gmail.com>
 * @license MIT License, http://www.opensource.org/licenses/MIT
 */
!function(){"use strict";function calculateAllDistances(){var elmts=nav.listOfFocusableElements,current=nav.current;return nav.focusableTargets=calculateDistances(elmts,current),nav.focusableTargets}function takeADecision(direction){function fliter_0(focusabletargets,focusedEl,direction,focusableGroups,focusableGroupName){if(null===focusableGroupName)return focusabletargets;var lon=focusableGroups.length,i=0;for(i;lon>i;i++){var att_f_group_name=focusableGroups[i].getAttribute("data-focus-group-name");if(focusableGroupName===att_f_group_name)break}var arr=getListOffocusableItems(focusableGroups[i]);return arr}function fliter_1(focusabletargets,focusedEl,direction){var arr=[];if(!(focusabletargets.length>1))return focusabletargets;for(var i=0;i<focusabletargets.length;i++)"UP"===direction&&focusabletargets[i].cy<focusedEl.cy&&arr.push(focusabletargets[i]),"RIGHT"===direction&&focusabletargets[i].cx>focusedEl.cx&&arr.push(focusabletargets[i]),"DOWN"===direction&&focusabletargets[i].cy>focusedEl.cy&&arr.push(focusabletargets[i]),"LEFT"===direction&&focusabletargets[i].cx<focusedEl.cx&&arr.push(focusabletargets[i]);return arr}function fliter_3_1(focusabletargets,focusedEl,direction){var arr=[];if(!(focusabletargets.length>1))return focusabletargets;for(var i=0;i<focusabletargets.length;i++)("UP"===direction||"DOWN"===direction)&&focusabletargets[i].x2>focusedEl.x1&&focusabletargets[i].x1<focusedEl.x2&&arr.push(focusabletargets[i]),("RIGHT"===direction||"LEFT"===direction)&&focusabletargets[i].y2>focusedEl.y1&&focusabletargets[i].y1<focusedEl.y2&&arr.push(focusabletargets[i]);return 0===arr.length?focusabletargets:arr}function fliter_4(focusabletargets){var el=null,min=null;if(focusabletargets.length>1){for(var i=0;i<focusabletargets.length;i++)0===i?(el=focusabletargets[0],min=focusabletargets[0].distance):focusabletargets[i].distance<min&&0!=focusabletargets[i].distance&&(el=focusabletargets[i],min=focusabletargets[i].distance);return el}return 1===focusabletargets.length?focusabletargets[0]:-1}var decisionIndex=-1,tempTargets=[];tempTargets=fliter_0(nav.focusableTargets,nav.current,direction,nav.listOfFocusableGroups,nav.curretGroup),tempTargets=fliter_1(nav.focusableTargets,nav.current,direction);var tempTargets_2=fliter_3_1(tempTargets,nav.current,direction);return tempTargets=tempTargets_2,tempTargets=fliter_4(tempTargets,nav.current,direction),decisionIndex=tempTargets?tempTargets.id:null}var checkInit=function(){if(null==nav.current.el){refreshFocusableMap();var rnd=Math.floor(Math.random()*nav.listOfFocusableElements.length)+0;focusItem(rnd)}},refreshFocusableMap=function(){refreshListOfFocusableItems(),refreshListOfFocusableGroups()},refreshListOfFocusableItems=function(className){nav.listOfFocusableElements=getListOffocusableItems();for(var i=0;i<nav.listOfFocusableElements.length;i++)""===nav.listOfFocusableElements[i].id&&(nav.listOfFocusableElements[i].id=Date.now()+i)},refreshListOfFocusableGroups=function(className){nav.listOfFocusableGroups=getListOffocusableGroups();for(var i=0;i<nav.listOfFocusableGroups.length;i++)""===nav.listOfFocusableGroups[i].id&&(nav.listOfFocusableGroups[i].id=Date.now()+i)},getListOffocusableItems=function(domEl,className){return className||(className="focusable"),domEl||(domEl=document),domEl.getElementsByClassName(className)},getListOffocusableGroups=function(domEl,className){return className||(className="focusable-group"),domEl||(domEl=document),domEl.getElementsByClassName(className)},Utils={addClass:function(domEl,styleName){if(null===domEl||null===styleName)return-1;var arr,element=domEl;arr=element.className.split(" "),-1==arr.indexOf(styleName)&&(element.className+=" "+styleName)},removeClass:function(domEl,styleName){if(null===domEl||null===styleName)return-1;var element=domEl;element.classList.remove(styleName)},removeClassFromElements:function(arrOfElements,styleName){for(var i=0;i<arrOfElements.length;i++)this.removeClass(arrOfElements[i],styleName)},getRandomNum:function(min,max){return Math.floor(Math.random()*(max-min+1))+min},substract:function(a,b){return a===b?0:a>b?a-b:b-a},getDistance:function(x1,y1,x2,y2){return Math.sqrt(Math.pow(x2-x1,2)+Math.pow(y2-y1,2))},getAngle:function(originX,originY,destinyX,destinyY){}},Filters={filter_targets_in_area_by_max_min:function(x1,y1,x2,y2,targets){for(var arr=[],lon=targets.length,i=0;lon>i;i++)targets[i].x1>=x1&&targets[i].x2<=x2&&targets[i].y1>=y1&&targets[i].y2<=y2&&arr.push(targets[i]);return arr},filter_targets_in_area_by_center_xy:function(x1,y1,x2,y2,targets){for(var arr=[],i=0;i<targets.length;i++)targets[i].cx>=x1&&targets[i].cx<=x2&&targets[i].cy>=y1&&targets[i].cy<=y2&&arr.push(targets[i]);return arr},filter_targets_nearest_to_xy:function(x,y,targets){var current=null,i=0,lon=targets.length,ld=null,d=null;for(i;lon>i;i++)0===i?(current=targets[0],ld=Utils.getDistance(targets[0].cx,targets[0].cy,x,y)):(d=Utils.getDistance(targets[i].cx,targets[i].cy,x,y),ld>d&&(current=targets[i],ld=d));return current}},focusArea=function(areaId,v,h){if(void 0===areaId||null===areaId)return-1;v||(v="top"),h||(h="left");var el=document.getElementById(areaId);if(null===el)return-1;var domRect=el.getBoundingClientRect(),p={};p.x1=domRect.left,p.y1=domRect.top,p.x2=domRect.right,p.y2=domRect.bottom;var corner={};"top"===v?"left"===h?(corner.x=p.x1,corner.y=p.y1):(corner.x=p.x2,corner.y=p.y1):"left"===h?(corner.x=p.x1,corner.y=p.y2):(corner.x=p.x2,corner.y=p.y2),refreshFocusableMap();var targets=calculateAllDistances();targets=Filters.filter_targets_in_area_by_max_min(p.x1,p.y1,p.x2,p.y2,targets);var targetElement=Filters.filter_targets_nearest_to_xy(corner.x,corner.y,targets);return nav.focusById(targetElement.id),targetElement},focusItem=function(num){return void 0===num||null===num||0>num?-1:void(nav.listOfFocusableElements.length>0&&(nav.current.el=nav.listOfFocusableElements[num],nav.current.domRect=nav.current.el.getBoundingClientRect(),nav.current.c=nav.current.domRect.right-nav.current.domRect.left,nav.current.c=nav.current.domRect.bottom-nav.current.domRect.top,nav.current.w=nav.current.domRect.right-nav.current.domRect.left,nav.current.h=nav.current.domRect.bottom-nav.current.domRect.top,nav.current.cx=nav.current.domRect.left+nav.current.w/2,nav.current.cy=nav.current.domRect.top+nav.current.h/2,nav.current.x1=nav.current.domRect.left,nav.current.x2=nav.current.domRect.right,nav.current.y1=nav.current.domRect.top,nav.current.y2=nav.current.domRect.bottom,removeFocusedClassFromAllElements(),Utils.addClass(nav.current.el,"focused")))},removeFocusedClassFromAllElements=function(){Utils.removeClassFromElements(document.getElementsByClassName("focusable"),"focused")},calculateDistances=function(arrOfElements,currentEl){for(var resultsArr=[],i=0;i<arrOfElements.length;i++){var el=arrOfElements[i],domRect=el.getBoundingClientRect(),p={};p.id=el.id,p.x1=domRect.left,p.y1=domRect.top,p.x2=domRect.right,p.y2=domRect.bottom,p.w=domRect.right-domRect.left,p.h=domRect.bottom-domRect.top,p.cx=domRect.left+p.w/2,p.cy=domRect.top+p.h/2,p.distance=Utils.getDistance(currentEl.cx,currentEl.cy,p.cx,p.cy),0!==p.distance&&(p.angle=Utils.getAngle(),p.distance_axis_x=Utils.substract(p.cx,currentEl.cx),p.distance_axis_y=Utils.substract(p.cy,currentEl.cy),p.slope=null,p.group=null,p.area=null,resultsArr.push(p))}return resultsArr},getFocusableGroupName=function(){},doAction=function(){},focusById=function(targetID){refreshListOfFocusableItems(),removeFocusedClassFromAllElements();for(var num=null,i=0;i<nav.listOfFocusableElements.length;i++)nav.listOfFocusableElements[i].id==targetID&&(num=i);focusItem(num)};window.nav={current:{el:null},init:function(){},reset:function(){this.current.el=null,checkInit(),calculateAllDistances()},curretGroup:null,previousSelectedElement:null,w:null,h:null,cx:null,cy:null,listOfFocusableElements:[],focusableTargets:[],getFocusableGroupName:null,actionFunction:function(e){null!=e.att_href,null!=e.att_f_link&&(window.location=e.att_f_link),null!=e.att_f_func&&eval(e.att_f_func)},move:{up:function(){checkInit(),calculateAllDistances();var selectedIndex=takeADecision("UP");return focusItem(selectedIndex),nav.current.el},down:function(){checkInit(),calculateAllDistances();var selectedIndex=takeADecision("DOWN");return focusItem(selectedIndex),nav.current.el},right:function(){checkInit(),calculateAllDistances();var selectedIndex=takeADecision("RIGHT");return focusItem(selectedIndex),nav.current.el},left:function(){checkInit(),calculateAllDistances();var selectedIndex=takeADecision("LEFT");return focusItem(selectedIndex),nav.current.el},rnd:function(){},to:function(){}},groupBy:function(groupName){this.curretGroup=groupName},ungroup:function(){this.curretGroup=null},action:function(){var att_href=this.current.el.getAttribute("href"),att_f_link=this.current.el.getAttribute("data-focus-action-link"),att_f_func=this.current.el.getAttribute("data-focus-action-function"),e={el:this.current,att_href:att_href,att_f_link:att_f_link,att_f_func:att_f_func};this.actionFunction(e)},getNextElement:function(arrOfElements,currentElement,movDirection,filterNameOrID){return null===arrOfElements?void 0:void 0===currentElement||null===currentElement?void this.applySelectionStyle(arrOfElements[Utils.getRandomNum(0,arrOfElements.length-1)]):(null===filterNameOrID&&(filterNameOrID="RANDOM"),null===movDirection&&(filterNameOrID="RANDOM"),automaticallyGetNextElement(arrOfElements,currentElement,movDirection,filterNameOrID))},applySelectionStyle:function(domElement){return void 0===domElement||null===domElement?-1:(null!=nav.current.el&&Utils.removeClass(nav.current.el,"focused"),nav.current.el=domElement,void Utils.addClass(nav.current.el,"focused"))},focusById:focusById,focusArea:focusArea,map:{draw:function(){var arr=nav.focusableTargets,lon=arr.length,i=0,el=document.getElementById("map-el"),str="",scale=.3;for(null===el&&(el=document.createElement("div"),el.id="map-el",el.style.cssText="position:absolute;top:0;left:0;width:100%;height:100%;opacity:1;z-index:1000;background:red;transform: scale("+scale+");transform-origin: 0 0;",document.body.appendChild(el)),i;lon>i;i++){var d=arr[i];str+='<div style="position:absolute; top:'+d.y1+"px;left:"+d.x1+"px; width:"+d.w+"px;height:"+d.h+'px; background-color: cyan; outline: 1px solid blue;">'+i+"</div>"}el.innerHTML=str},clear:function(){var el=document.getElementById("map-el");null!==el&&document.body.removeChild(el)}}}}();