/**
 * spatial-navigator
 * JS spatial navigation library.
 * @version 0.1.1 - 2018-05-13
 * @link https://github.com/ajsoriar/spatial-navigator
 * @author Andres J. Soria R. <ajsoriar@gmail.com>
 * @license MIT License, http://www.opensource.org/licenses/MIT
 */
!function(){"use strict";function calculateAllDistances(){var elmts=nav.listOfFocusableElements,current=nav.current;nav.focusableTargets=calculateDistances(elmts,current)}function takeADecision(direction){var FILTERS_GROUP=1;if(1===FILTERS_GROUP){for(var decisionIndex=-1,target=[],i=0;i<nav.focusableTargets.length;i++)1===direction&&nav.focusableTargets[i].cy<nav.current.cy&&target.push(nav.focusableTargets[i]),2===direction&&nav.focusableTargets[i].cx>nav.current.cx&&target.push(nav.focusableTargets[i]),3===direction&&nav.focusableTargets[i].cy>nav.current.cy&&target.push(nav.focusableTargets[i]),4===direction&&nav.focusableTargets[i].cx<nav.current.cx&&target.push(nav.focusableTargets[i]);for(var selectedObj=null,minDistance=null,i=0;i<target.length;i++)0===i?(selectedObj=target[0],minDistance=target[0].distance):target[i].distance<minDistance&&0!=target[i].distance&&(selectedObj=target[i],minDistance=target[i].distance);return decisionIndex=selectedObj?selectedObj.id:null}if(2===FILTERS_GROUP){for(var selectedObj=null,min_distance=null,i=0;i<nav.focusableTargets.length;i++)0===i?(selectedObj=focusableTargets[0],min_distance=focusableTargets[0].distance):focusableTargets[i].distance<min_distance&&0!=focusableTargets[i].distance&&(selectedObj=focusableTargets[i],min_distance=focusableTargets[i].distance);return decisionIndex=selectedObj.id}}var checkInit=function(){if(null===nav.current.el){refreshListOfFocusableItems();var rnd=Math.floor(Math.random()*nav.listOfFocusableElements.length)+0;focusItem(rnd)}},refreshListOfFocusableItems=function(cssLabel){cssLabel||(cssLabel="focusable"),nav.listOfFocusableElements=document.getElementsByClassName(cssLabel);for(var i=0;i<nav.listOfFocusableElements.length;i++)""==nav.listOfFocusableElements[i].id&&(nav.listOfFocusableElements[i].id=i,nav.listOfFocusableElements[i].innerHTML=i)},Utils={addClass:function(domEl,styleName){if(null===domEl||null===styleName)return-1;var arr,element=domEl;arr=element.className.split(" "),-1==arr.indexOf(styleName)&&(element.className+=" "+styleName)},removeClass:function(domEl,styleName){if(null===domEl||null===styleName)return-1;var element=domEl;element.classList.remove(styleName)},removeClassFromElements:function(arrOfElements,styleName){for(var i=0;i<arrOfElements.length;i++)this.removeClass(arrOfElements[i],styleName)},getRandomNum:function(min,max){return Math.floor(Math.random()*(max-min+1))+min},substract:function(a,b){return a===b?0:a>b?a-b:b-a},getDistance:function(x1,y1,x2,y2){return Math.sqrt(Math.pow(x2-x1,2)+Math.pow(y2-y1,2))},getAngle:function(originX,originY,destinyX,destinyY){},getRandomNum:function(min,max){return Math.floor(Math.random()*(max-min+1))+min}},focusItem=function(num){null===num||0>num||nav.listOfFocusableElements.length>0&&(nav.current.el=nav.listOfFocusableElements[num],nav.current.domRect=nav.current.el.getBoundingClientRect(),nav.current.c=nav.current.domRect.right-nav.current.domRect.left,nav.current.c=nav.current.domRect.bottom-nav.current.domRect.top,nav.current.w=nav.current.domRect.right-nav.current.domRect.left,nav.current.h=nav.current.domRect.bottom-nav.current.domRect.top,nav.current.cx=nav.current.domRect.left+nav.current.w/2,nav.current.cy=nav.current.domRect.top+nav.current.h/2,nav.current.x1=nav.current.domRect.left,nav.current.x2=nav.current.domRect.right,nav.current.y1=nav.current.domRect.top,nav.current.y2=nav.current.domRect.bottom,removeFocusedClassFromAllElements(),Utils.addClass(nav.current.el,"focused"))},removeFocusedClassFromAllElements=function(){Utils.removeClassFromElements(document.getElementsByClassName("focusable"),"focused")},calculateDistances=function(arrOfElements,currentEl){for(var resultsArr=[],i=0;i<arrOfElements.length;i++){var el=arrOfElements[i],domRect=el.getBoundingClientRect(),p={};p.id=el.id,p.x1=domRect.left,p.y1=domRect.top,p.x2=domRect.right,p.y2=domRect.bottom,p.w=domRect.right-domRect.left,p.h=domRect.bottom-domRect.top,p.cx=domRect.left+p.w/2,p.cy=domRect.top+p.h/2,p.distance=Utils.getDistance(currentEl.cx,currentEl.cy,p.cx,p.cy),0!==p.distance&&(p.angle=Utils.getAngle(),p.distance_axis_x=Utils.substract(p.cx,currentEl.cx),p.distance_axis_y=Utils.substract(p.cy,currentEl.cy),p.slope=null,p.group=null,resultsArr.push(p))}return resultsArr},automaticallyGetNextElement=function(arrOfElements,currentElement,movDirection,filterNameOrID){function filter_half_half(arrOfElements,currentElement){for(var filteredElements=(arrOfElements.length,[]),i=0;i<arrOfElements.length;i++)(1==direction||"UP"==direction)&&arrOfElements[i].cy<currentElement.cy&&filteredElements.push(arrOfElements[i]),(2==direction||"RIGHT"==direction)&&arrOfElements[i].cx>currentElement.cx&&filteredElements.push(arrOfElements[i]),(3==direction||"DOWN"==direction)&&arrOfElements[i].cy>currentElement.cy&&filteredElements.push(arrOfElements[i]),(4==direction||"LEFT"==direction)&&arrOfElements[i].cx<currentElement.cx&&filteredElements.push(arrOfElements[i]);return filteredElements}function filter_range(arrOfElements,currentElement){for(var filteredElements=(arrOfElements.length,[]),i=0;i<arrOfElements.length;i++)(1===direction||3===direction||"UP"==direction||"DOWN"==direction)&&arrOfElements[i].cx>nav.current.x1&&arrOfElements[i].cx<nav.current.x2&&filteredElements.push(arrOfElements[i]),(2===direction||4===direction||"RIGHT"==direction||"LEFT"==direction)&&arrOfElements[i].cy>nav.current.y1&&arrOfElements[i].cy<nav.current.y2&&filteredElements.push(arrOfElements[i]);return filteredElements}function filter_nearest(arrOfElements,currentElement){for(var filteredElements=(arrOfElements.length,[]),i=0;i<workArr.length;i++)0===i?(selectedObj=arrOfElements[0],minDistance=arrOfElements[0].distance):arrOfElements[i].distance<minDistance&&0!=arrOfElements[i].distance&&(selectedObj=arrOfElements[i],minDistance=arrOfElements[i].distance);return filteredElements}if(!currentElement)return null;var workArr=calculateDistances(arrOfElements,currentElement);return workArr=filter_half_half(workArr,currentElement),workArr=filter_range(workArr,currentElement),workArr=filter_nearest(workArr,currentElement)},focusById=function(targetID){refreshListOfFocusableItems(),removeFocusedClassFromAllElements();for(var num=null,i=0;i<nav.listOfFocusableElements.length;i++)nav.listOfFocusableElements[i].id==targetID&&(num=i);focusItem(num)};window.nav={current:{el:null},previousSelectedElement:null,selectedElement:null,w:null,h:null,cx:null,cy:null,listOfFocusableElements:[],focusableTargets:[],init:function(){checkInit(),calculateAllDistances()},move:{up:function(){checkInit(),calculateAllDistances();var selectedIndex=takeADecision(1);return focusItem(selectedIndex),nav.selectedElement},down:function(){checkInit(),calculateAllDistances();var selectedIndex=takeADecision(3);return focusItem(selectedIndex),nav.selectedElement},right:function(){checkInit(),calculateAllDistances();var selectedIndex=takeADecision(2);return focusItem(selectedIndex),nav.selectedElement},left:function(){checkInit(),calculateAllDistances();var selectedIndex=takeADecision(4);return focusItem(selectedIndex),nav.selectedElement},rnd:function(){},to:function(){}},reset:function(){this.current.el=null,checkInit(),calculateAllDistances()},action:function(){var atributo=this.current.el.getAttribute("data-link");window.router.goTo(atributo)},recalculateContainers:function(){},applyRandomDecision:function(){},getNextElement:function(arrOfElements,currentElement,movDirection,filterNameOrID){return null===arrOfElements?void 0:void 0===currentElement||null===currentElement?void this.applySelectionStyle(arrOfElements[Utils.getRandomNum(0,arrOfElements.length-1)]):(null===filterNameOrID&&(filterNameOrID="RANDOM"),null===movDirection&&(filterNameOrID="RANDOM"),automaticallyGetNextElement(arrOfElements,currentElement,movDirection,filterNameOrID))},applySelectionStyle:function(domElement){return void 0===domElement||null===domElement?-1:(null!=nav.current.el&&Utils.removeClass(nav.current.el,"focused"),nav.current.el=domElement,void Utils.addClass(nav.current.el,"focused"))},focusById:focusById}}();