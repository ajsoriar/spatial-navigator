/**
 * spatial-navigator
 * JS spatial navigation library.
 * @version 1.0.0 - 2018-05-13
 * @link https://github.com/ajsoriar/spatial-navigator
 * @author Andres J. Soria R. <ajsoriar@gmail.com>
 * @license MIT License, http://www.opensource.org/licenses/MIT
 */
!function(){"use strict";function calculateAllDistances(){var elmts=nav.listOfFocusableElements,current=nav.current;nav.focusableTargets=calculateDistances(elmts,current)}function takeADecision(direction){function fliter_1(focusabletargets,focusedEl,direction){var arr=[];if(!(focusabletargets.length>1))return focusabletargets;for(var i=0;i<focusabletargets.length;i++)"UP"===direction&&focusabletargets[i].cy<focusedEl.cy&&arr.push(focusabletargets[i]),"RIGHT"===direction&&focusabletargets[i].cx>focusedEl.cx&&arr.push(focusabletargets[i]),"DOWN"===direction&&focusabletargets[i].cy>focusedEl.cy&&arr.push(focusabletargets[i]),"LEFT"===direction&&focusabletargets[i].cx<focusedEl.cx&&arr.push(focusabletargets[i]);return arr}function fliter_3(focusabletargets,focusedEl,direction){var arr=[];if(!(focusabletargets.length>1))return focusabletargets;for(var i=0;i<focusabletargets.length;i++)("UP"===direction||"DOWN"===direction)&&focusabletargets[i].cx>focusedEl.x1&&focusabletargets[i].cx<focusedEl.x2&&arr.push(focusabletargets[i]),("RIGHT"===direction||"LEFT"===direction)&&focusabletargets[i].cy>focusedEl.y1&&focusabletargets[i].cy<focusedEl.y2&&arr.push(focusabletargets[i]);return 0===arr.length?focusabletargets:arr}function fliter_4(focusabletargets){var el=null,min=null;if(focusabletargets.length>1){for(var i=0;i<focusabletargets.length;i++)0===i?(el=focusabletargets[0],min=focusabletargets[0].distance):focusabletargets[i].distance<min&&0!=focusabletargets[i].distance&&(el=focusabletargets[i],min=focusabletargets[i].distance);return el}return 1===focusabletargets.length?focusabletargets[0]:-1}var decisionIndex=-1,tempTargets=[];tempTargets=fliter_1(nav.focusableTargets,nav.current,direction);var tempTargets_1=fliter_3(tempTargets,nav.current,direction);return tempTargets=tempTargets_1,tempTargets=fliter_4(tempTargets,nav.current,direction),decisionIndex=tempTargets?tempTargets.id:null}var checkInit=function(){if(null===nav.current.el){refreshListOfFocusableItems();var rnd=Math.floor(Math.random()*nav.listOfFocusableElements.length)+0;focusItem(rnd)}},refreshListOfFocusableItems=function(cssLabel){cssLabel||(cssLabel="focusable"),nav.listOfFocusableElements=document.getElementsByClassName(cssLabel);for(var i=0;i<nav.listOfFocusableElements.length;i++)""==nav.listOfFocusableElements[i].id&&(nav.listOfFocusableElements[i].id=Date.now()+i)},Utils={addClass:function(domEl,styleName){if(null===domEl||null===styleName)return-1;var arr,element=domEl;arr=element.className.split(" "),-1==arr.indexOf(styleName)&&(element.className+=" "+styleName)},removeClass:function(domEl,styleName){if(null===domEl||null===styleName)return-1;var element=domEl;element.classList.remove(styleName)},removeClassFromElements:function(arrOfElements,styleName){for(var i=0;i<arrOfElements.length;i++)this.removeClass(arrOfElements[i],styleName)},getRandomNum:function(min,max){return Math.floor(Math.random()*(max-min+1))+min},substract:function(a,b){return a===b?0:a>b?a-b:b-a},getDistance:function(x1,y1,x2,y2){return Math.sqrt(Math.pow(x2-x1,2)+Math.pow(y2-y1,2))},getAngle:function(originX,originY,destinyX,destinyY){},getRandomNum:function(min,max){return Math.floor(Math.random()*(max-min+1))+min}},focusItem=function(num){null===num||void 0===num||0>num||nav.listOfFocusableElements.length>0&&(nav.current.el=nav.listOfFocusableElements[num],nav.current.domRect=nav.current.el.getBoundingClientRect(),nav.current.c=nav.current.domRect.right-nav.current.domRect.left,nav.current.c=nav.current.domRect.bottom-nav.current.domRect.top,nav.current.w=nav.current.domRect.right-nav.current.domRect.left,nav.current.h=nav.current.domRect.bottom-nav.current.domRect.top,nav.current.cx=nav.current.domRect.left+nav.current.w/2,nav.current.cy=nav.current.domRect.top+nav.current.h/2,nav.current.x1=nav.current.domRect.left,nav.current.x2=nav.current.domRect.right,nav.current.y1=nav.current.domRect.top,nav.current.y2=nav.current.domRect.bottom,removeFocusedClassFromAllElements(),Utils.addClass(nav.current.el,"focused"))},removeFocusedClassFromAllElements=function(){Utils.removeClassFromElements(document.getElementsByClassName("focusable"),"focused")},calculateDistances=function(arrOfElements,currentEl){for(var resultsArr=[],i=0;i<arrOfElements.length;i++){var el=arrOfElements[i],domRect=el.getBoundingClientRect(),p={};p.id=el.id,p.x1=domRect.left,p.y1=domRect.top,p.x2=domRect.right,p.y2=domRect.bottom,p.w=domRect.right-domRect.left,p.h=domRect.bottom-domRect.top,p.cx=domRect.left+p.w/2,p.cy=domRect.top+p.h/2,p.distance=Utils.getDistance(currentEl.cx,currentEl.cy,p.cx,p.cy),0!==p.distance&&(p.angle=Utils.getAngle(),p.distance_axis_x=Utils.substract(p.cx,currentEl.cx),p.distance_axis_y=Utils.substract(p.cy,currentEl.cy),p.slope=null,p.group=null,resultsArr.push(p))}return resultsArr},doAction=function(){},focusById=function(targetID){refreshListOfFocusableItems(),removeFocusedClassFromAllElements();for(var num=null,i=0;i<nav.listOfFocusableElements.length;i++)nav.listOfFocusableElements[i].id==targetID&&(num=i);focusItem(num)};window.nav={current:{el:null},previousSelectedElement:null,selectedElement:null,w:null,h:null,cx:null,cy:null,listOfFocusableElements:[],focusableTargets:[],actionFunction:function(e){null!=e.att_href,null!=e.att_f_link&&(window.location=e.att_f_link),null!=e.att_f_func&&eval(e.att_f_func)},move:{up:function(){checkInit(),calculateAllDistances();var selectedIndex=takeADecision("UP");return focusItem(selectedIndex),nav.selectedElement},down:function(){checkInit(),calculateAllDistances();var selectedIndex=takeADecision("DOWN");return focusItem(selectedIndex),nav.selectedElement},right:function(){checkInit(),calculateAllDistances();var selectedIndex=takeADecision("RIGHT");return focusItem(selectedIndex),nav.selectedElement},left:function(){checkInit(),calculateAllDistances();var selectedIndex=takeADecision("LEFT");return focusItem(selectedIndex),nav.selectedElement},rnd:function(){},to:function(){}},reset:function(){this.current.el=null,checkInit(),calculateAllDistances()},action:function(){var att_href=this.current.el.getAttribute("href"),att_f_link=this.current.el.getAttribute("data-focused-link"),att_f_func=this.current.el.getAttribute("data-focused-function"),e={el:this.current,att_href:att_href,att_f_link:att_f_link,att_f_func:att_f_func};this.actionFunction(e)},recalculateContainers:function(){},applyRandomDecision:function(){},getNextElement:function(arrOfElements,currentElement,movDirection,filterNameOrID){return null===arrOfElements?void 0:void 0===currentElement||null===currentElement?void this.applySelectionStyle(arrOfElements[Utils.getRandomNum(0,arrOfElements.length-1)]):(null===filterNameOrID&&(filterNameOrID="RANDOM"),null===movDirection&&(filterNameOrID="RANDOM"),automaticallyGetNextElement(arrOfElements,currentElement,movDirection,filterNameOrID))},applySelectionStyle:function(domElement){return void 0===domElement||null===domElement?-1:(null!=nav.current.el&&Utils.removeClass(nav.current.el,"focused"),nav.current.el=domElement,void Utils.addClass(nav.current.el,"focused"))},focusById:focusById}}();